---
layout: post
title: (Spring) - 스프링이 제공하는 ServletContainerInitializer 
date: 2024-05-10
categories: [spring]
---

> - 스프링은 ServletContainerInitializer 인터페이스를 구현한 클래스로 SpringServletContainerInitializer를 사용하며, <span style="color:red">개발자가 실제 구현해야 하는 것은 WebApplicationInitializer</span>이다.
<center><img src="https://github.com/LeeJae-H/LeeJae-H.github.io/assets/122717063/af7f09d3-6061-4fc2-8124-73fdde2cb87c" width="700" height="330"></center>

### SpringServletContainerInitializer
```java
@HandlesTypes({WebApplicationInitializer.class})
public class SpringServletContainerInitializer implements ServletContainerInitializer 
    {
        public void onStartup(@Nullable Set<Class<?>> webAppInitializerClasses, 
                              ServletContext servletContext) 
                              throws ServletException 
        {
            ...
            initializer.onStartup(servletContext);
            ...
        }
    }
```
- 서블릿 컨테이너가 시작될 때 클래스패스에 spring-web 모듈 JAR 파일이 있으면, 서블릿 컨테이너는 SpringServletContainerInitializer를 로드하고 인스턴스화한 후, 이 클래스의 onStartup 메서드를 호출한다. 
- onStartup 메서드는 서블릿 컨테이너의 초기화 작업 중 하나로서, Spring의 WebApplicationInitializer 구현체들을 찾아서 초기화하는 역할을 한다.
    - WebApplicationInitializer 구현체가 없는 경우
        - 만약 클래스패스에서 WebApplicationInitializer 구현체를 찾을 수 없다면, 이 메서드는 아무 작업도 수행하지 않는다. 이 경우, INFO 레벨의 로그 메시지를 남겨서 ServletContainerInitializer가 호출되었지만 WebApplicationInitializer 구현체를 찾지 못했음을 사용자에게 알린다.
    - WebApplicationInitializer 구현체가 있는 경우
        - 하나 이상의 WebApplicationInitializer 타입이 감지되면, 이 구현체들은 인스턴스화된다. (만약 @Order 어노테이션이 존재하거나 Ordered 인터페이스를 구현한 경우, 이 구현체들은 정렬된다.) 그런 다음, 각 인스턴스의 WebApplicationInitializer.onStartup(ServletContext) 메서드가 호출된다. 이 과정에서 ServletContext가 각 인스턴스에 위임되어 각 인스턴스가 Spring의 DispatcherServlet, ContextLoaderListener 등의 서블릿, 리스너 또는 필터와 같은 서블릿 API 기능을 등록하고 구성할 수 있도록 한다. 
            - ServletContext 객체의 생성은 서블릿 컨테이너가 하고, 초기화 작업은 WebApplcationInitializer가 한다.
            - 즉, 서블릿 컨테이너가 생성한 ServletContext를 SpringServletContainerInitializer가 받아서, 이를 사용자 정의 WebApplicationInitializer 구현체들에게 전달(delegating)한다는 의미이다.

- 요약하자면, 서블릿 컨테이너를 실행하면 서블릿 컨테이너를 초기화하는데, 이 과정에서 핵심은 ServletContext 객체를 초기화하는 것이다. 이 ServletContext 객체를 초기화하는 방법은 web.xml 방식과 SpringServletContainerInitializer 방식이다.


### WebApplicationInitializer



---
참고 자료  
https://tomcat.apache.org/tomcat-7.0-doc/servletapi/javax/servlet/ServletContainerInitializer.html  
https://tomcat.apache.org/tomcat-8.0-doc/servletapi/javax/servlet/ServletContext.html  
https://tomcat.apache.org/tomcat-7.0-doc/servletapi/javax/servlet/ServletRegistration.Dynamic.html  
https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/SpringServletContainerInitializer.html  
https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/WebApplicationInitializer.html  
https://kimcoder.tistory.com/511  
https://recordsoflife.tistory.com/490  
https://escapefromcoding.tistory.com/174  
https://offbyone.tistory.com/215  
https://nhs0912.tistory.com/81  
https://blog.naver.com/kitepc/221314687808  
https://velog.io/@rolroralra/Chapter0.-Servlet-컨테이너-Spring-컨테이너  
