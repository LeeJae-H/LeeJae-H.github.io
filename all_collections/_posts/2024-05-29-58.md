---
layout: post
title: (Spring) - Bean과 컴포넌트 스캔
date: 2024-05-29
categories: [spring]
---
### Bean(빈)
- 스프링에서의 빈은 <span style="color:blueviolet">스프링 컨테이너(=IoC 컨테이너=DI 컨테이너)에 의해 관리되는 특별한 객체</span>이다.  

- **스프링 빈 VS 일반적인 객체**
    1. 생성과 관리
        - 스프링 빈은 스프링 컨테이너에 의해 생성되고 관리됨 
        - 일반적인 객체는 개발자가 직접 생성하고 관리함
    2. <span style="color:blueviolet">의존성 주입(Dependency Injection, DI)</span>
    - 스프링 빈은 의존성 주입을 통해 다른 빈들과의 관계를 설정할 수 있으며, 이를 통해 객체 간의 결합도를 낮추고 유연성을 높임
    - 일반적인 객체는 의존 객체를 직접 생성하고 주입해야 함
    3. 스코프(Scope)
    - 스프링 빈은 스코프(scope)를 가질 수 있습니다. 예를 들어, 싱글톤(Singleton), 프로토타입(Prototype), 요청(Request), 세션(Session) 등의 다양한 스코프를 설정할 수 있습니다.
    - 반면에 일반적인 객체는 보통 애플리케이션 전체에서 하나의 인스턴스만을 갖는 싱글톤이 기본적인 스코프입니다.
    4. AOP(Aspect-Oriented Programming)
    - 스프링은 AOP를 지원하고, 빈에 대한 프록시(proxy)를 생성하여 횡단 관심사(cross-cutting concerns)를 구현할 수 있습니다. 예를 들어, 트랜잭션 관리, 보안 등을 쉽게 적용할 수 있습니다.
    - 반면에 일반적인 객체는 AOP를 직접 구현하기 어렵고, 특정 기능을 추가하기 위해서는 코드의 많은 수정이 필요할 수 있습니다.

- 스프링에서의 빈은 일반적인 객체와는 달리 스프링 프레임워크의 기능과 규칙을 따라 동작하는 특별한 객체로 볼 수 있습니다. 스프링의 IoC 컨테이너는 이러한 빈들을 생성, 관리하고, 필요에 따라 의존성을 주입하여 개발자가 객체의 생명주기와 관련된 복잡한 작업을 처리하도록 도와줍니다.





- 어떤 요청이 들어오면 일단 디스패처 서블릿이 모든 요청을 받고, 디스패처 서블릿이 어노테이션을 찾아서 요청의 url에 맞는 컨트롤러를 찾음.
    - 요청이 왔을 때 디스패처 서블릿은 서버가 실행될때 이미 생성되어있어 생성과 init()을 할 필요가 없음. 컨트롤러 인스턴스는 싱글톤 빈으로 관리되며, 기본적으로 스프링 컨테이너가 시작될 때 미리 생성됨.
    - 컨트롤러의 인스턴스가 생성되는 시점
        1. 미리 생성
            - @Controller 어노테이션이 붙은 클래스는 스프링 컨테이너가 초기화될 때 자동으로 스캔되어 빈으로 등록됩니다. 따라서 서버가 시작될 때 스프링 컨테이너가 해당 컨트롤러 클래스를 스캔하고 인스턴스를 생성합니다.
            - XML 또는 자바 설정 파일에 명시적으로 빈을 등록한 경우에도 스프링 컨테이너가 시작될 때 해당 빈이 인스턴스화됩니다.
        2. 요청이 들어올때 마다 생성
            - 요청이 들어올 때마다 컨트롤러를 생성하는 방법도 있습니다. 이 경우는 프로토타입(scope="prototype") 범위로 컨트롤러를 정의하여 요청이 들어올 때마다 새로운 인스턴스를 생성합니다. 하지만 이 방법은 매번 요청이 들어올 때마다 컨트롤러를 생성하므로 성능상의 이슈가 있을 수 있습니다.
    - 스프링 컨테이너 생성 시점
        - 스프링 컨테이너는 웹 애플리케이션이 서버에 배포되고 서버가 시작될 때 초기화됩니다. 이때 서블릿 컨테이너가 시작되고 서블릿이 로딩되고 초기화되는 과정에서 스프링 컨테이너도 함께 초기화됩니다.
        - 스프링 컨테이너의 초기화는 대개 다음과 같은 시점에서 이루어집니다.
            1. 웹 애플리케이션 컨텍스트의 로딩 시점: 웹 애플리케이션 컨텍스트는 스프링의 핵심이 되는 객체로서, 서블릿 컨테이너가 웹 애플리케이션을 로딩할 때 생성됩니다. 따라서 스프링 컨테이너는 웹 애플리케이션 컨텍스트의 로딩 시점에 초기화됩니다.
            2. ContextLoaderListener 또는 FrameworkServlet의 초기화: 스프링 웹 애플리케이션에서는 ContextLoaderListener 또는 FrameworkServlet이 서블릿 컨테이너에 의해 초기화됩니다. 이 때 ContextLoaderListener는 root 웹 애플리케이션 컨텍스트를 초기화하고, FrameworkServlet은 서블릿 웹 애플리케이션 컨텍스트를 초기화합니다.
            3. @ServletInitializer 또는 web.xml 파일의 설정: 스프링 부트 애플리케이션에서는 ServletInitializer 클래스를 사용하여 스프링 컨테이너를 초기화할 수 있습니다. 또한 전통적인 웹 애플리케이션에서는 web.xml 파일의 설정을 통해 스프링 컨테이너를 초기화할 수도 있습니다.
- 초기화된 스프링 컨테이너는 애플리케이션의 빈들을 관리하고, 요청에 따라 적절한 빈을 찾아서 의존성 주입 등을 수행하여 요청을 처리하는 데 사용됩니다.




---
참고 자료  
https://steady-coding.tistory.com/594  

